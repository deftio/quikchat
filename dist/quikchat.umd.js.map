{"version":3,"file":"quikchat.umd.js","sources":["../src/quikchat.js"],"sourcesContent":["\nclass quikchat {\n    /**\n     * \n     * @param string or DOM element  parentElement \n     * @param {*} meta \n     */\n    constructor(parentElement, \n            meta = { \n                theme: 'quikchat-theme-light', \n                onSend: () => { }, \n                trackHistory: true,\n                titleArea: {title: \"Title Area\", show: false, align: \"center\"}\n            }) \n        {\n        if (typeof parentElement === 'string') {\n            parentElement = document.querySelector(parentElement);\n        }\n        this._parentElement = parentElement;\n        this._theme = meta.theme;\n        this._onSend = meta.onSend ? meta.onSend : () => { };\n        this._createWidget();\n        // title area\n        if (meta.titleArea) {\n            this.titleAreaSetContents(meta.titleArea.title, meta.titleArea.align);\n            if (meta.titleArea.show == true) {\n                this.titleAreaShow();\n            } else {\n                this.titleAreaHide();\n            }\n        }\n        this._attachEventListeners();\n        this.trackHistory = meta.trackHistory || true;\n        this._historyLimit = 10000000;\n        this._history = [];\n    }\n\n    _createWidget() {\n        const widgetHTML =\n            `\n            <div class=\"quikchat-base ${this.theme}\">\n                <div class=\"quikchat-title-area\">\n                    <span style=\"font-size: 1.5em; font-weight: 600;\">Title Area</span>\n                </div>\n                <div class=\"quikchat-messages-area\"></div>\n                <div class=\"quikchat-input-area\">\n                    <textarea class=\"quikchat-input-textbox\"></textarea>\n                    <button class=\"quikchat-input-send-btn\">Send</button>\n                </div>\n            </div>\n            `;\n\n        this._parentElement.innerHTML = widgetHTML;\n        this._chatWidget = this._parentElement.querySelector('.quikchat-base');\n        this._titleArea = this._chatWidget.querySelector('.quikchat-title-area');\n        this._messagesArea = this._chatWidget.querySelector('.quikchat-messages-area');\n        this._inputArea = this._chatWidget.querySelector('.quikchat-input-area');\n        this._textEntry = this._inputArea.querySelector('.quikchat-input-textbox');\n        this._sendButton = this._inputArea.querySelector('.quikchat-input-send-btn');\n        this.msgid = 0;\n    }\n\n    _attachEventListeners() {\n        this._sendButton.addEventListener('click', () => this._onSend(this, this._textEntry.value.trim()));\n        window.addEventListener('resize', () => this._handleContainerResize());\n        this._chatWidget.addEventListener('resize', () => this._handleContainerResize());\n        this._textEntry.addEventListener('keydown', (event) => {\n            // Check if Shift + Enter is pressed\n            if (event.shiftKey && event.keyCode === 13) {\n                // Prevent default behavior (adding new line)\n                event.preventDefault();\n                this._onSend(this, this._textEntry.value.trim())\n            }\n        });\n    }\n    // set the onSend function callback.\n    setCallbackOnSend(callback) {\n        this._onSend = callback;\n    }\n    // set a callback for everytime a message is added (listener)\n    setCallbackonMessageAdded(callback) {\n        this._onMessageAdded = callback;\n    }\n\n    // Public methods\n    titleAreaToggle() {\n        this._titleArea.style.display === 'none' ? this.titleAreaShow() : this.titleAreaHide();\n    }\n\n    titleAreaShow() {\n        this._titleArea.style.display = '';\n        this._adjustMessagesAreaHeight();\n    }\n\n    titleAreaHide() {\n        this._titleArea.style.display = 'none';\n        this._adjustMessagesAreaHeight();\n    }\n\n    titleAreaSetContents(title, align = 'center') {\n        this._titleArea.innerHTML = title;\n        this._titleArea.style.textAlign = align;\n    }\n\n    titleAreaGetContents() {\n        return this._titleArea.innerHTML;\n    }\n\n    inputAreaToggle() {\n        this._inputArea.classList.toggle('hidden');\n        this._inputArea.style.display === 'none' ? this.inputAreaShow() : this.inputAreaHide();\n    }\n\n    inputAreaShow() {\n        this._inputArea.style.display = '';\n        this._adjustMessagesAreaHeight();\n    }\n\n    inputAreaHide() {\n        this._inputArea.style.display = 'none';\n        this._adjustMessagesAreaHeight();\n    }\n\n    _adjustMessagesAreaHeight() {\n        const hiddenElements = [...this._chatWidget.children].filter(child => child.classList.contains('hidden'));\n        const totalHiddenHeight = hiddenElements.reduce((sum, child) => sum + child.offsetHeight, 0);\n        const containerHeight = this._chatWidget.offsetHeight;\n        this._messagesArea.style.height = `calc(100% - ${containerHeight - totalHiddenHeight}px)`;\n    }\n\n    _handleContainerResize() {\n        this._adjustMessagesAreaHeight();\n        this._adjustSendButtonWidth();\n        //console.log('Container resized');\n    }\n\n    _adjustSendButtonWidth() {\n        const sendButtonText = this._sendButton.textContent.trim();\n        const fontSize = parseFloat(getComputedStyle(this._sendButton).fontSize);\n        const minWidth = fontSize * sendButtonText.length + 16;\n        this._sendButton.style.minWidth = `${minWidth}px`;\n    }\n   \n    messageAddFull(input = {content: \"\", userString: \"user\", align : \"right\", role : \"user\", userID : -1}) {\n        const msgid = this.msgid;\n        const messageDiv = document.createElement('div');\n        const msgidClass = 'quikchat-msgid-' + String(msgid).padStart(10, '0');\n        const userIdClass = 'quikchat-userid-' + String(input.userString).padStart(10, '0'); // hash this..\n        messageDiv.classList.add('quikchat-message', msgidClass);\n        this.msgid++;\n        messageDiv.classList.add(this._messagesArea.children.length % 2 === 1 ? 'quikchat-message-1' : 'quikchat-message-2');\n     \n        const userDiv = document.createElement('div');\n        userDiv.innerHTML = input.userString;\n        userDiv.style = `width: 100%; text-align: ${input.align}; font-size: 1em; font-weight:700;`;\n\n        const contentDiv = document.createElement('div');\n        contentDiv.style = `width: 100%; text-align: ${input.align};`;\n        contentDiv.innerHTML = input.content;\n\n        messageDiv.appendChild(userDiv);\n        messageDiv.appendChild(contentDiv);\n        this._messagesArea.appendChild(messageDiv);\n        //this._messagesArea.lastChild.scrollIntoView();\n        this._messagesArea.lastElementChild.scrollIntoView()\n\n        this._textEntry.value = '';\n        this._adjustMessagesAreaHeight();\n        const timestamp = new Date().toISOString();\n        const updatedtime = timestamp;\n        if (this.trackHistory) {\n            this._history.push({ msgid, ...input, timestamp, updatedtime, messageDiv});\n            if (this._history.length > this._historyLimit) {\n                this._history.shift();\n            }\n        }\n        if (this._onMessageAdded) {\n            this._onMessageAdded(this, msgid);\n        };\n        return msgid;\n    }\n    messageAddNew(content=\"\", userString=\"user\", align = \"right\", role = \"user\") {\n        return this.messageAddFull(  \n            {content: content, userString: userString, align: align, role: role}\n        );\n    }\n    messageRemove(n) {\n        // use css selector to remove the message\n        let sucess = false;\n        try {\n            this._messagesArea.removeChild(this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`));\n            sucess = true;\n        }\n        catch (error) {\n            console.log(`{String(n)} : Message ID not found`);\n        }\n        if (sucess) {\n            // slow way to remove from history\n            //this._history = this._history.filter((item) => item.msgid !== n); // todo make this more efficient\n\n            // better way to delete this from history\n            this._history.splice(this._history.findIndex((item) => item.msgid === n), 1);\n        }\n        return sucess;\n    }\n    /* returns the message html object from the DOM\n    */\n    messageGetDOMObject(n) {\n        let msg = null;\n        // now use css selector to get the message \n        try {\n            msg =  this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`);\n        } \n        catch (error) \n        {\n            console.log(`{String(n)} : Message ID not found`);\n        }\n        return msg; \n    }\n    /* returns the message content only\n    */\n    messageGetContent(n) {\n        let content = \"\"\n        // now use css selector to get the message \n        try {\n            // get from history..\n            content = this._history.filter((item) => item.msgid === n)[0].content;\n            //content =  this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`).lastChild.textContent;\n        } \n        catch (error) \n        {\n            console.log(`{String(n)} : Message ID not found`);\n        }\n        return content; \n    }\n\n    /* append message to the message content\n    */\n    messageAppendContent(n, content) {\n        let sucess = false;\n        try {\n            this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`).lastChild.innerHTML += content;\n            // update history\n            let item = this._history.filter((item) => item.msgid === n)[0];\n            item.content += content;\n            item.updatedtime = new Date().toISOString();\n            sucess = true;\n            //this._messagesArea.lastChild.scrollIntoView();\n            this._messagesArea.lastElementChild.scrollIntoView()\n        } \n        catch (error) \n        {\n            console.log(`{String(n)} : Message ID not found`);\n        }   \n    }\n    /* replace message content\n    */\n    messageReplaceContent(n, content) {\n        let sucess = false;\n        try {\n            this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`).lastChild.innerHTML = content;\n            // update history\n            this._history.filter((item) => item.msgid === n)[0].content = content;\n            sucess = true;\n        } \n        catch (error) \n        {\n            console.log(`{String(n)} : Message ID not found`);\n        }\n        return sucess;\n    }\n    // history functions\n    /**\n     * \n     * @param {*} n \n     * @param {*} m \n     * @returns array of history messages\n     */\n    historyGet(n,m) {\n\n        if (n == undefined) {\n            n = 0;\n            m= this._history.length;\n        }\n        if (m === undefined) {\n            m = n < 0 ? m: n + 1;\n        }\n        // remember that entries could be deleted.  TODO: So we need to return the actual history entries\n        // so now we need to find the array index that correspondes to messageIds n (start) and m (end)\n        \n        return this._history.slice(n,m);\n    }\n\n    historyClear() {\n        this.msgid = 0;\n        this._history = [];\n    }   \n\n    historyGetLength() {\n        return this._history.length;\n    }   \n\n    historyGetMessage(n) {\n        if ( n>=0 && n < this._history.length) {\n            this._history[n];\n        }\n        return {};\n\n    }      \n\n    historyGetMessageContent(n) {\n        return this._history[n].message;\n    }\n\n\n    changeTheme(newTheme) {\n        this._chatWidget.classList.remove(this._theme);\n        this._chatWidget.classList.add(newTheme);\n        this._theme = newTheme;\n    }\n\n    get theme() {\n        return this._theme;\n    }\n\n    static version() {\n        return {\"version\" : \"1.0.4\", \"license\" : \"BSD-2\", \"url\" :\"https://github/deftio/quikchat\"};\n    }\n}\n\nexport default quikchat;\n"],"names":["quikchat","parentElement","meta","arguments","length","undefined","theme","onSend","trackHistory","titleArea","title","show","align","_classCallCheck","document","querySelector","_parentElement","_theme","_onSend","_createWidget","titleAreaSetContents","titleAreaShow","titleAreaHide","_attachEventListeners","_historyLimit","_history","_createClass","key","value","widgetHTML","concat","innerHTML","_chatWidget","_titleArea","_messagesArea","_inputArea","_textEntry","_sendButton","msgid","_this","addEventListener","trim","window","_handleContainerResize","event","shiftKey","keyCode","preventDefault","setCallbackOnSend","callback","setCallbackonMessageAdded","_onMessageAdded","titleAreaToggle","style","display","_adjustMessagesAreaHeight","textAlign","titleAreaGetContents","inputAreaToggle","classList","toggle","inputAreaShow","inputAreaHide","hiddenElements","_toConsumableArray","children","filter","child","contains","totalHiddenHeight","reduce","sum","offsetHeight","containerHeight","height","_adjustSendButtonWidth","sendButtonText","textContent","fontSize","parseFloat","getComputedStyle","minWidth","messageAddFull","input","content","userString","role","userID","messageDiv","createElement","msgidClass","String","padStart","add","userDiv","contentDiv","appendChild","lastElementChild","scrollIntoView","timestamp","Date","toISOString","updatedtime","push","_objectSpread","shift","messageAddNew","messageRemove","n","sucess","removeChild","error","console","log","splice","findIndex","item","messageGetDOMObject","msg","messageGetContent","messageAppendContent","lastChild","messageReplaceContent","historyGet","m","slice","historyClear","historyGetLength","historyGetMessage","historyGetMessageContent","message","changeTheme","newTheme","remove","get","version"],"mappings":"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"}