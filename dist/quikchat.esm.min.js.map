{"version":3,"file":"quikchat.esm.min.js","sources":["../src/quikchat.js"],"sourcesContent":["\nclass quikchat {\n    constructor(parentElement, \n        meta = { \n            theme: 'quikchat-theme-light', \n            onSend: () => { },\n            trackHistory: true,\n        }) {\n        if (typeof parentElement === 'string') {\n            parentElement = document.querySelector(parentElement);\n        }\n        this._parentElement = parentElement;\n        this._theme = meta.theme;\n        this._onSend = meta.onSend ? meta.onSend : () => { };\n        this._createWidget();\n        // title area\n        if (meta.titleArea) {\n            this.titleAreaSetContents(meta.titleArea.title, meta.titleArea.align);\n            if (meta.titleArea.show) {\n                this.titleAreaShow();\n            } else {\n                this.titleAreaHide();\n            }\n        }\n        this._attachEventListeners();\n        this._history = [];\n    }\n\n    _createWidget() {\n        const widgetHTML =\n            `\n            <div class=\"quikchat-base ${this.theme}\">\n                <div class=\"quikchat-title-area\">\n                    <span style=\"font-size: 1.5em; font-weight: 600;\">Title Area</span>\n                </div>\n                <div class=\"quikchat-messages-area\"></div>\n                <div class=\"quikchat-input-area\">\n                    <textarea class=\"quikchat-input-textbox\"></textarea>\n                    <button class=\"quikchat-input-send-btn\">Send</button>\n                </div>\n            </div>\n            `;\n\n        this._parentElement.innerHTML = widgetHTML;\n        this._chatWidget = this._parentElement.querySelector('.quikchat-base');\n        this._titleArea = this._chatWidget.querySelector('.quikchat-title-area');\n        this._messagesArea = this._chatWidget.querySelector('.quikchat-messages-area');\n        this._inputArea = this._chatWidget.querySelector('.quikchat-input-area');\n        this._textEntry = this._inputArea.querySelector('.quikchat-input-textbox');\n        this._sendButton = this._inputArea.querySelector('.quikchat-input-send-btn');\n        this.msgid = 0;\n    }\n    $() {\n    }\n    _attachEventListeners() {\n        this._sendButton.addEventListener('click', () => this._onSend(this, this._textEntry.value.trim()));\n        window.addEventListener('resize', () => this._handleContainerResize());\n        this._chatWidget.addEventListener('resize', () => this._handleContainerResize());\n        this._textEntry.addEventListener('keydown', (event) => {\n            // Check if Shift + Enter is pressed\n            if (event.shiftKey && event.keyCode === 13) {\n                // Prevent default behavior (adding new line)\n                event.preventDefault();\n                this._onSend(this, this._textEntry.value.trim())\n            }\n        });\n    }\n\n    titleAreaToggle() {\n        this._titleArea.style.display === 'none' ? this.titleAreaShow() : this.titleAreaHide();\n    }\n\n    titleAreaShow() {\n        this._titleArea.style.display = '';\n        this._adjustMessagesAreaHeight();\n    }\n\n    titleAreaHide() {\n        this._titleArea.style.display = 'none';\n        this._adjustMessagesAreaHeight();\n    }\n\n    titleAreaSetContents(title, align = 'center') {\n        this._titleArea.innerHTML = title;\n        this._titleArea.style.textAlign = align;\n    }\n\n    titleAreaGetContents() {\n        return this._titleArea.innerHTML;\n    }\n\n    inputAreaToggle() {\n        this._inputArea.classList.toggle('hidden');\n        this._inputArea.style.display === 'none' ? this.inputAreaShow() : this.inputAreaHide();\n    }\n\n    inputAreaShow() {\n        this._inputArea.style.display = '';\n        this._adjustMessagesAreaHeight();\n    }\n\n    inputAreaHide() {\n        this._inputArea.style.display = 'none';\n        this._adjustMessagesAreaHeight();\n    }\n\n    _adjustMessagesAreaHeight() {\n        const hiddenElements = [...this._chatWidget.children].filter(child => child.classList.contains('hidden'));\n        const totalHiddenHeight = hiddenElements.reduce((sum, child) => sum + child.offsetHeight, 0);\n        const containerHeight = this._chatWidget.offsetHeight;\n        this._messagesArea.style.height = `calc(100% - ${containerHeight - totalHiddenHeight}px)`;\n    }\n\n    _handleContainerResize() {\n        this._adjustMessagesAreaHeight();\n        this._adjustSendButtonWidth();\n        //console.log('Container resized');\n    }\n\n    _adjustSendButtonWidth() {\n        const sendButtonText = this._sendButton.textContent.trim();\n        const fontSize = parseFloat(getComputedStyle(this._sendButton).fontSize);\n        const minWidth = fontSize * sendButtonText.length + 16;\n        this._sendButton.style.minWidth = `${minWidth}px`;\n    }\n\n    messageAddNew(message, user = \"foo\", align = 'left') {\n        const messageDiv = document.createElement('div');\n        const msgid = this.msgid;\n        const msgidClass = 'quikchat-msgid-' + String(msgid).padStart(10, '0');\n        messageDiv.classList.add('quikchat-message', msgidClass);\n        this.msgid++;\n        messageDiv.classList.add(this._messagesArea.children.length % 2 === 1 ? 'quikchat-message-1' : 'quikchat-message-2');\n\n        const userDiv = document.createElement('div');\n        userDiv.innerHTML = user;\n        userDiv.style = `width: 100%; text-align: ${align}; font-size: 1em; font-weight:700; color: #444;`;\n\n        const contentDiv = document.createElement('div');\n        contentDiv.style = `width: 100%; text-align: ${align};`;\n        contentDiv.innerHTML = message;\n\n        messageDiv.appendChild(userDiv);\n        messageDiv.appendChild(contentDiv);\n        this._messagesArea.appendChild(messageDiv);\n        this._messagesArea.lastChild.scrollIntoView();\n\n        this._textEntry.value = '';\n        this._adjustMessagesAreaHeight();\n        return {msgid};\n    }\n\n    messageRemove(n) {\n        // use css selector to remove the message\n        let sucess = false;\n        try {\n            this._messagesArea.removeChild(this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`));\n            sucess = true;\n        }\n        catch (error) {\n            console.log(`{String(n)} : Message ID not found`);\n        }\n        return sucess;\n    }\n    /* returns the message html object from the DOM\n    */\n    messageGetDOMObject(n) {\n        let msg = null;\n        // now use css selector to get the message \n        try {\n            msg =  this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`);\n        } \n        catch (error) \n        {\n            console.log(`{String(n)} : Message ID not found`);\n        }\n        return msg; \n    }\n    /* returns the message content only\n    */\n    messageGetContent(n) {\n        let content = \"\"\n        // now use css selector to get the message \n        try {\n            content =  this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`).lastChild.textContent;\n        } \n        catch (error) \n        {\n            console.log(`{String(n)} : Message ID not found`);\n        }\n        return content; \n    }\n\n    /* append message to the message content\n    */\n    messageAppendContent(n, content) {\n        let sucess = false;\n        try {\n            this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`).lastChild.innerHTML += content;\n            sucess = true;\n        } \n        catch (error) \n        {\n            console.log(`{String(n)} : Message ID not found`);\n        }   \n    }\n    /* replace message content\n    */\n    messageReplaceContent(n, content) {\n        let sucess = false;\n        try {\n            this._messagesArea.querySelector(`.quikchat-msgid-${String(n).padStart(10, '0')}`).lastChild.innerHTML = content;\n            sucess = true;\n        } \n        catch (error) \n        {\n            console.log(`{String(n)} : Message ID not found`);\n        }\n        return sucess;\n    }\n\n    changeTheme(newTheme) {\n        this._chatWidget.classList.remove(this._theme);\n        this._chatWidget.classList.add(newTheme);\n        this._theme = newTheme;\n    }\n\n    get theme() {\n        return this._theme;\n    }\n\n    static getVersion() {\n        return {\"version\" : \"1.0.2\"}\n    }\n}\n\nexport default quikchat;\n"],"names":["quikchat","parentElement","meta","arguments","length","undefined","theme","onSend","trackHistory","_classCallCheck","document","querySelector","this","_parentElement","_theme","_onSend","_createWidget","titleArea","titleAreaSetContents","title","align","show","titleAreaShow","titleAreaHide","_attachEventListeners","_history","key","value","widgetHTML","concat","innerHTML","_chatWidget","_titleArea","_messagesArea","_inputArea","_textEntry","_sendButton","msgid","_this","addEventListener","trim","window","_handleContainerResize","event","shiftKey","keyCode","preventDefault","style","display","_adjustMessagesAreaHeight","textAlign","classList","toggle","inputAreaShow","inputAreaHide","totalHiddenHeight","_toConsumableArray","children","filter","child","contains","reduce","sum","offsetHeight","containerHeight","height","_adjustSendButtonWidth","sendButtonText","textContent","minWidth","parseFloat","getComputedStyle","fontSize","message","user","messageDiv","createElement","msgidClass","String","padStart","add","userDiv","contentDiv","appendChild","lastChild","scrollIntoView","n","sucess","removeChild","error","console","log","msg","content","newTheme","remove","get","version"],"mappings":"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"}